Eustachy i LCSy
Problem code: EUSTACHY | Time: 30 s | Memory: 16 MB | Solved: no | print

Eustachy wszystkie nudne wykłady spędza w ten sam sposób: losuje k niepustych ciagów znaków (każdy z nich składający się z co najwyżej 500 liter) i próbuje wyliczyć, jaki jest ich najdłuższy wspólny podciąg. Po ostatnim (wyjątkowo nudnym) semestrze postanowił trochę utrudnić sobie życie: oprócz długości najdłuższego wspólnego podciągu chciałby wyliczyć też ile jest różnych wspólnych podciągów o takiej długości.
Wejście

W pierwszym wierszu podana jest ilość ciągów k (2 lub 3). Następne k wierszy zawiera niepuste ciągi znaków składające się z co najwyżej 500 małych liter alfabetu angielskiego.
Wyjście

Należy wypisać dwie liczby: długość najdłuższego wspólnego podciągu podanych k napisów oraz ilość różnych najdłuższych podciągów (modulo 10^9).
Przykład

Dla danych wejściowych
2
aaabbaababaaabaaabbaaaaabbaabababa
ababbababbbbaaabbbbaaababababa
poprawną odpowiedzią jest
25 4